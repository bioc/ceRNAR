---
title: "ceRNAR: an R package for identification and analysis of ceRNAs-miRNA triplets"
author: "Yi-Wen Hsiao†, Lin Wang† and Tzu-Pin Lu"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ceRNAR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r style, echo=FALSE, results="asis", message=FALSE}
knitr::opts_chunk$set(tidy = FALSE,
                      warning = FALSE,
                      message = FALSE)
```


# Introduction


# General Workflow

## Data preprocessing

First, we need to import the package and its dependencies

```{r, warning=FALSE, message=FALSE}
library(ceRNAR)
```


To illustrate functionality of ceRNAR, a small toy dataset (including gene and miRNA expression and clinical data) extracted from TCGA pan-cancer altas is used. 
Larger expression datasets can be obtained via either `ceRNAcustomize()` to load user's own data or `ceRNAcustomize()` to load data from TCGA. Once importing the package, the toy dataset to can be accessed via `data()`:

- Gene expression:

```{r}
data(gene_exp)
```

```{r, echo=FALSE}
knitr::kable(gene_exp[1:5,1:5])
```

- miRNA expression:

```{r}
data(mirna_exp)
```

```{r, echo=FALSE}
knitr::kable(mirna_exp[1:5,1:5])
```

- clinical data:

```{r}
data("surv_data")
```

```{r, echo=FALSE}
knitr::kable(surv_data[1:5,1:2])
```


Then, `ceRNACustomize()` is used to further preprocess and check the data

```{r, eval=FALSE}
ceRNACustomize(project_name = 'demo', disease_name = 'DLBC', gene_exp = gene_exp,  mirna_exp = mirna_exp, surv_data = surv_data)
```

Alternatively, `ceRNATCGA()` can be used to retrieve TCGA data

```{r}
ceRNATCGA(project_name = 'TCGA',disease_name = 'DLBC', timeout = 5000000)
```

## Putative miRNA-gene interaction

Here, ceRNAR comes with 2 experimentally validated miRNA-target databases and 7 computationally predicted miRNA-target databases for only considering genes with shared miRNAs. Three options for filtering putative miRNA-gene pairs:

- `strict`: experimentally validated by 2 databases and predicted by 7 databaes 
- `moderate`: experimentally validated by 2 databases or predicted by 7 databaes
- `less`:experimentally validated by 2 databases or predicted by more than 6 databaes

```{r}
ceRNAputativePairs(project_name = 'demo', disease_name = 'DLBC', filtering = 'less')
```

## ceRNA interaction

```{r, echo=FALSE}
cernar_result <- ceRNAMethod(project_name = 'demo', disease_name = "DLBC", window_size = 45/5)
```

```{r, echo=FALSE}

knitr::kable(cernar_result[1:5,1:5])
```


## Downstream analyses

- Functional analysis

```{r, eval=FALSE}
ceRNAFunction(project_name = 'demo', disease_name = 'DLBC', pairs_cutoff = 1)
```

- Location plot

```{r,eval=FALSE}
ceRNALocation(project_name = 'demo', disease_name = 'DLBC', mirna = 'hsa-miR-101-3p', 
              window_size = 45/5)
```

- Survival analysis

```{r,eval=FALSE}
ceRNAModule(project_name = 'demo', disease_name = 'DLBC', pairs_cutoff = 5, 
            column_sum = 1)
```

- Network analysis

```{r,eval=FALSE}
ceRNASurvival(project_name = 'demo', disease_name = 'DLBC', mirnas = 'hsa-miR-101-3p')
```

- External validation

```{r,eval=FALSE}
ceRNAValidate(project_name = 'demo', disease_name = 'DLBC')
```

- Data integration

```{r,eval=FALSE}
library(SPONGE)
ceRNAIntegrate(project_name = 'demo', disease_name = 'DLBC')
```



